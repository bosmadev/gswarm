name: Restore .env.keys
on:
  workflow_dispatch:

jobs:
  restore:
    if: github.actor == 'bosmadev'
    runs-on: ubuntu-latest
    steps:
      - name: Create .env.keys artifact
        env:
          DOTENV_PRIVATE_KEY: ${{ secrets.DOTENV_PRIVATE_KEY }}
        run: |
          if [ -z "$DOTENV_PRIVATE_KEY" ]; then
            echo "::error::DOTENV_PRIVATE_KEY secret not set"
            exit 1
          fi
          cat > env-keys.txt << 'HEADER'
          #/------------------!DOTENV_PRIVATE_KEYS!-------------------/
          #/ private decryption keys. DO NOT commit to source control /
          #/     [how it works](https://dotenvx.com/encryption)       /
          #/----------------------------------------------------------/
          HEADER
          echo "DOTENV_PRIVATE_KEY=$DOTENV_PRIVATE_KEY" >> env-keys.txt
          echo "âœ“ .env.keys artifact created"

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: env-keys
          path: env-keys.txt
          retention-days: 1
